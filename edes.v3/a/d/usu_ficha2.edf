[Title]@USUARIO/S@|l
[CC]#FormaSS|($_TaskStatus>0  && $_ViewDesktop==$_ENV['ON'])||SESS::$_D_!=''
[CC]#FormaSN|!$_Variable['#FormaSS'] && (($_TaskStatus>0  && $_ViewDesktop!=$_ENV['ON'])||SESS::$_D_!='')
[CC]#FormaNS|!$_Variable['#FormaSS'] && (($_TaskStatus==0 && $_ViewDesktop==$_ENV['ON'])||SESS::$_D_!='')
[PHPStart]*||unique
include_once($Dir_.$_Sql.'.inc');
qQuery( "select task_status,view_desktop from {$_ENV['eDesDictionary']}gs_user where cd_gs_user={$_User}" );
list( $_TaskStatus, $_ViewDesktop ) = qRow();
$_TaskStatus = (int)$_TaskStatus;
[DBTable]{$_ENV['eDesDictionary']}gs_user
[DBIndex]cd_gs_user; login||true|user_name,user_surname|@USUARIO YA EXISTE@|BorraOrigen
[DBOrder]user_name,user_surname
[DBSerial]cd_gs_user
¿ SESS::$_SystemUser!=$_ENV['ON'] ? [DBAddFilter] (system_user!='{$_ENV['ON']}' or system_user is null or system_user='{$_ENV['OFF']}')
[DBLimit]5000,750,750
[DBLog]cd_gs_user
[NoAbort]
[Cursor]
[AddOption]*|desktop_type|-1,@Por defecto@; 0,@Solapas@; 1,@Vertical@; 2,@Horizontal@
[AddOption]*|permission|,; S,@Si@; N,@No@; C,@Caducado@
[AddOption]a|permission|S,@Si@; N,@No@
[AddOption]?|permission|,; S,@Si@; N,@No@; C,@Caducado@; )'S'(,@Sin permiso@
[TipForm]*|phone2|@Segundo Teléfono@
[TipForm]*|ip|@Primera IP@
[TipForm]*|ip2|@Segunda IP@
[TipForm]*|ip_from|@IP-Inicial@
[TipForm]*|ip_to|@IP-Final@
[AddCode]cR|cd_gs_node|A|<span><i title='@Consultar Local@' onclick='top.eSWOpen(window,"edes.php?FcR:$a/d/nodo.edf&_SEEK&cd_gs_node="+eGF("cd_gs_node")+"&_NOBUTTON","LOCAL",false)'>&#209;</i><span style='margin-left:20px' id='_VerExplorer'>@Información@ <i title='@Datos del explorador@' onclick='VerExplorer()'>&#251;</i></span>
#!(t1) [WhereSelect] a,mR | cd_gs_tree | cd_gs_tree!=1
[SlideCol]3
[OnChange]*|dni|ePadLeft(this,8)
[ListCheckBox]H|<img src=g/tf_1.gif>
[GroupLabels]Format|TipTH
pc_total	| b
new_pass	| b
permission	|   | @Permiso@
log_user	|   | @Log Usuario@
log_history	|   | @Log Histórico@
webmaster	|   | @WebMaster@
[Fields]?|2
@DNI@|dni|DNI|T|8||Qcpq|||
,2 @Usuario@|cd_gs_user|+|T|5||Qq|||
@Nombre@|user_name|X|T|20||Qd|||
,2 @Apellidos@|user_surname|X|T|30||Q|||
@Local@|cd_gs_node|+|S|3,60|+user_surname|QI|||
@Departamento@|cd_gs_office|+|S|40|+user_surname|Q|||
@Cargo@|cd_gs_position|+|S|30|+user_surname|Q|||
@E-Mail@|email|@|T|65|+user_surname|Q|||
-|@PERMISOS@|||||Q|||
@Permiso@|permission|X|SV|11||Q|||
,  @Nivel exportación@|export_level|+|SV|12||Q|||
¿ SESS::$_SystemUser==$_ENV['ON'] ? ,@System·User@|system_user|D|c|1||Q|||
¿ SESS::$_SystemUser==$_ENV['ON'] ? ,@WebMaster@|webmaster|D|c|1||Q|||
@Perfil@|cd_gs_rol_exp|+|S|50|+user_surname|Q|||
[CC]#ConIdioma|qCount("{$_ENV['eDesDictionary']}gs_language")>0
[AddOptionValue]cd_gs_language|img_sel|lng_
[AddOption]*|verify_pass|,; E,EMail; S,SMS
[Fields]4||trim
#!(l)     @DNI@|dni|DNI|T|8||MLcp||#|
,  @Usuario@|cd_gs_user|+|T|5|>user_surname|a=*; *=-|||
#!(l),3 @Fecha·Alta@|dt_add|F4|T|10||-|#today#||
@Nombre@|user_name|X|T|20||M||#|
,2 @Apellidos@|user_surname|X|T|30||M||#|
,|dt_access_last|F4|T|10||*|#today#||
#(l) @Fecha·Alta@|dt_add|F4|T|10||-|#today#||
,3 @Fecha·Baja@|dt_del|F4|T|10||MF|||
@Local@|cd_gs_node|+|S|60|+user_surname|M||#|
,3 @LOPD@|dt_confidential|F4|T|10||-L|||
@Teléfonos@|phone|T|T|9||ML|||
,|phone2|T|T|9||ML|||
,  @Cargo@|cd_gs_position|+|S|30|>user_surname/user_surname|M|||
@Departamento@|cd_gs_office|+|S|40|cd_gs_node|M|||
@E-Mail@|email|@|T|65|cd_gs_node|ME|||
-|@PERMISOS@
@Login@|login|#|T|65|+cd_gs_node|ML|||
@Permiso@|permission|N|SV|8||M|S|#|
#ConIdioma ¿
,2 @Idioma@|cd_gs_language|n|S|12|>user_surname/user_surname|M|@LNG@||
?¿
,  @Idioma@|cd_gs_language|n|T|12||*|@LNG@||
?
,3 @Verificación en 2 pasos@\@2 Pasos@|verify_pass|N|SV|1|42|M|||
&#49;ª IP - 2ª IP\1ª IP|ip|X|T|15|87|M|||
,  \2ª IP|ip2|X|T|15|87|M|||
#!(l)  ,3 @Cambiar·clave@|new_pass|+|T|1||MS|1||
@IP Rango@\@IP·INI@|ip_from|X|T|15|87|M|||
,  \@IP·FIN@|ip_to|X|T|15|87|M|||
#FormaSS ¿
?
¿ #FormaNS ? 3 @Visor Escritorio Remoto@|view_desktop|D|C|1||ML|||
-|@OBSERVACIONES@
<|notes|#|H|250,90,4|+cd_gs_node|ML|||
|ys_news|CDI|T|19||*|#y2s#||
#(a)|pass|D|T|32||*|||
|system_user|||||h|||
-|@PERFIL DE USUARIO@
[Plugin]*|$a/plugin/usertree.form|10|10|C|300|450
[Plugin]*|$a/plugin/usertree.body
[AddOption]*|task_status|,; 1,@Iniciar@; 2,@Enviar@; 3,@Asignar@; 4,@Desarrollo@
[TipForm]*|task_status|@Desde que estado se crean incidencias@
[PHPForm]a,mR
if( SESS::$_WebMaster==$_ENV['ON'] ) $_Form['webmaster'][6] = 'M';
[JSIni]a,mR
function BorraOrigen(){
ePF("dni,email", '', false);
}
[PHPIni]a,mR
global $_JSCHECK;
eFileGetVar("Login", true);
$cmp = $Type;
if($cmp=="") $cmp= "email";
if( $cmp!="login" ){
$_JSCHECK .= "S(':login').val(S(':{$cmp}').val());";
$_Form[array_search("login", array_column($_Form, 1))][_MODE] = '*';
}
$_Form[array_search($cmp, array_column($_Form, 1))][_CONDITION] = '#';
[PHPEnd]cR
echo '<script type="text/javascript">';
echo 'function VerExplorer(){';
sql_Busca("{$_ENV['eDesDictionary']}gs_conexion", '*', "cd_gs_user={$_Fila['cd_gs_user']}", 'cdi desc');
$row = sql_Array();
if( $row['cd_gs_navegador']!='' ){
sql_Busca("{$_ENV['eDesDictionary']}gs_navegador", '*', "cd_gs_navegador={$row['cd_gs_navegador']}");
$row2 = sql_Array();
if( $row2["cd_gs_navegador"]>0 ){
echo 'top.eSWOpen(window, "edes.php?FcR:$a/d/e_nave.edf&_SEEK&'.'cd_gs_navegador='. $row['cd_gs_navegador'].'","@WTEXPLORADOR@",false );';
}
}
echo '}';
if( $row2["cd_gs_navegador"]=="" ) echo 'S("#_VerExplorer").none();';
echo '</script>';
[PHPIni]M -NO-
qQuery( "select cd_gs_language from {$_ENV['eDesDictionary']}gs_user where cd_gs_user={$cd_gs_user}" );
list($cd_gs_languageBAK) = qRow();
[DBEnd]M -NO-
if( $cd_gs_languageBAK!=$_vF['cd_gs_language'] ){
SESS::$_LANGUAGE_ = $_vF['cd_gs_language'];
$_JSINCLUDEFILE = "/_tmp/php/language_set.".SESS::$_User;
include("../../edes.v3/language_set.php");
}
[DBIni]M
$_uActivarPermiso = false;
if( $_POST["permission"]=="S" ){
qQuery("select permission from {$_ENV['eDesDictionary']}gs_user where cd_gs_user=".$_POST["cd_gs_user"]);
$row=qArray();
if( $row["permission"]=="C" ) $_uActivarPermiso = true;
}
[DBEnd]M
if( $_uActivarPermiso ){
qQuery("update {$_ENV['eDesDictionary']}gs_user set dt_access_last='' where cd_gs_user=".$_POST["cd_gs_user"]);
}
[DBEnd]A
S::userInsert($_vF, "@Usuario no insertado@");
[Exit]